<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Home - Fake News Detector</title>
    <meta name="description" content="Stay informed with the latest news and AI-powered fact-checking technology.">
    <link href="https://fonts.googleapis.com" rel="preconnect"/>
    <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script>
        tailwind.config = {
          darkMode: "class",
          theme: {
            extend: {
              colors: {
                "primary": "#00ffff",
                "secondary": "#ff6b6b",
                "accent": "#4ecdc4",
                "background-light": "#f5f8f8",
                "background-dark": "#0f2323",
              },
              fontFamily: {
                "display": ["Work Sans"]
              },
              borderRadius: {
                "DEFAULT": "0.5rem",
                "lg": "1rem",
                "xl": "1.5rem",
                "full": "9999px"
              },
            },
          },
        }
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200">
    <div class="flex flex-col min-h-screen">
        <!-- Advanced Navigation -->
        <header class="sticky top-0 z-50 bg-gradient-to-r from-white/98 via-white/95 to-white/98 dark:from-gray-900/98 dark:via-gray-800/95 dark:to-gray-900/98 backdrop-blur-xl shadow-2xl border-b border-white/20 dark:border-gray-700/30">
            <!-- Animated Background Pattern -->
            <div class="absolute inset-0 bg-gradient-to-r from-primary/5 via-transparent to-accent/5 opacity-50"></div>
            
            <div class="relative container mx-auto px-6 py-5">
                <div class="flex justify-between items-center">
                    <!-- Enhanced Logo -->
                    <a class="group text-2xl font-black bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 dark:from-white dark:via-gray-100 dark:to-white bg-clip-text text-transparent flex items-center hover:scale-105 transition-all duration-300" href="/">
                        <div class="relative">
                            <span class="text-3xl mr-3 group-hover:rotate-12 transition-transform duration-300">üîç</span>
                            <div class="absolute -top-1 -right-1 w-2 h-2 bg-primary rounded-full animate-pulse"></div>
                        </div>
                        <span class="tracking-tight">Fake News Detector</span>
                    </a>
                    
                    <div class="flex items-center space-x-8">
                        <!-- Enhanced Navigation Links -->
                        <nav class="hidden md:flex space-x-8">
                            <a href="/home" class="relative group text-gray-700 dark:text-gray-300 hover:text-primary font-semibold transition-all duration-300 py-2 px-1">
                                <span class="relative z-10">Home</span>
                                <div class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-primary to-accent group-hover:w-full transition-all duration-300"></div>
                                <div class="absolute -top-1 -right-1 w-1 h-1 bg-primary rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                            </a>
                            <a href="/detector" class="relative group text-gray-700 dark:text-gray-300 hover:text-primary font-semibold transition-all duration-300 py-2 px-1">
                                <span class="relative z-10">Detector</span>
                                <div class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-accent to-secondary group-hover:w-full transition-all duration-300"></div>
                                <div class="absolute -top-1 -right-1 w-1 h-1 bg-accent rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                            </a>
                            <a href="/pricing" class="relative group text-gray-700 dark:text-gray-300 hover:text-primary font-semibold transition-all duration-300 py-2 px-1">
                                <span class="relative z-10">Plans</span>
                                <div class="absolute bottom-0 left-0 w-0 h-0.5 bg-gradient-to-r from-secondary to-primary group-hover:w-full transition-all duration-300"></div>
                                <div class="absolute -top-1 -right-1 w-1 h-1 bg-secondary rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
                            </a>
                        </nav>
                        
                        <!-- Enhanced Action Buttons -->
                        <div class="flex items-center space-x-4">
                            <!-- Login/Register Links -->
                            <a href="/login" class="text-gray-700 dark:text-gray-300 hover:text-primary font-semibold transition-colors duration-200">
                                Login
                            </a>
                            <a href="/register" class="bg-primary text-background-dark px-4 py-2 rounded-lg font-semibold hover:bg-primary/80 transition-colors duration-200">
                                Register
                            </a>
                            <!-- Simple Dark Mode Toggle -->
                            <button id="dark-mode-toggle" class="p-2 rounded-md bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
                                <span class="text-xl">üåô</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1">
            <!-- Hero Section with News Banners -->
            <section class="py-16 bg-gradient-to-br from-primary/10 via-transparent to-accent/10">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-12">
                        <h1 class="text-5xl font-bold bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 dark:from-white dark:via-gray-100 dark:to-white bg-clip-text text-transparent mb-6">
                            Stay Informed with Latest News
                        </h1>
                        <p class="text-xl text-gray-600 dark:text-gray-400 max-w-3xl mx-auto">
                            Get the latest news from trusted sources, automatically verified by our AI-powered fact-checking system.
                        </p>
                    </div>

                    <!-- News Banners Carousel -->
                    <div class="relative max-w-6xl mx-auto">
                        <div id="news-carousel" class="overflow-hidden rounded-2xl shadow-2xl">
                            <div class="flex transition-transform duration-500 ease-in-out" id="news-container">
                                <!-- News banners will be loaded here -->
                            </div>
                        </div>
                        
                    </div>
                </div>
            </section>

            <!-- User Feedback Section -->
            <section class="py-16 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-12">
                        <h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            What Our Users Say
                        </h2>
                        <p class="text-xl text-gray-600 dark:text-gray-400">
                            Real feedback from users who trust our fact-checking technology
                        </p>
                    </div>

                    <div id="feedback-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12">
                        <!-- User feedback will be loaded here -->
                    </div>

                </div>
            </section>

            <!-- Why Use This System Section -->
            <section class="py-16 bg-gradient-to-br from-accent/10 via-transparent to-primary/10">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-12">
                        <h2 class="text-4xl font-bold text-gray-900 dark:text-white mb-4">
                            Why Use Our System?
                        </h2>
                        <p class="text-xl text-gray-600 dark:text-gray-400">
                            Advanced AI technology meets real-world fact-checking needs
                        </p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        <!-- Feature 1 -->
                        <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-white/20 dark:border-gray-700/30">
                            <div class="text-4xl mb-4">ü§ñ</div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                                AI-Powered Detection
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                Our advanced machine learning models (SVM, LSTM, BERT) work together to achieve 99%+ accuracy in detecting fake news.
                            </p>
                        </div>

                        <!-- Feature 2 -->
                        <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-white/20 dark:border-gray-700/30">
                            <div class="text-4xl mb-4">‚ö°</div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                                Real-Time Verification
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                Get instant results with our NewsAPI integration that cross-references information with trusted news sources.
                            </p>
                        </div>

                        <!-- Feature 3 -->
                        <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-white/20 dark:border-gray-700/30">
                            <div class="text-4xl mb-4">üîí</div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                                Secure & Reliable
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                Enterprise-grade security with session management, user authentication, and data protection.
                            </p>
                        </div>

                        <!-- Feature 4 -->
                        <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-white/20 dark:border-gray-700/30">
                            <div class="text-4xl mb-4">üìä</div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                                Detailed Analytics
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                Comprehensive analysis with confidence scores, individual model results, and detailed explanations.
                            </p>
                        </div>

                        <!-- Feature 5 -->
                        <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-white/20 dark:border-gray-700/30">
                            <div class="text-4xl mb-4">üåê</div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                                Multi-Format Support
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                Analyze text, URLs, and news articles. Extract content from any web page for comprehensive verification.
                            </p>
                        </div>

                        <!-- Feature 6 -->
                        <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl p-8 shadow-xl border border-white/20 dark:border-gray-700/30">
                            <div class="text-4xl mb-4">üíº</div>
                            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">
                                Professional Grade
                            </h3>
                            <p class="text-gray-600 dark:text-gray-400">
                                Used by journalists, researchers, businesses, and organizations worldwide for reliable fact-checking.
                            </p>
                        </div>
                    </div>

                    <!-- Call to Action -->
                    <div class="text-center mt-12">
                        <a href="/detector" class="inline-flex items-center bg-gradient-to-r from-primary to-accent text-background-dark px-8 py-4 rounded-xl font-bold text-lg hover:shadow-xl transition-all duration-300 transform hover:scale-105">
                            <span class="mr-3">üîç</span>
                            Start Fact-Checking Now
                        </a>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-900 dark:bg-gray-800 text-white py-12">
            <div class="container mx-auto px-6">
                <div class="text-center">
                    <p class="text-gray-400">¬© 2025 Fake News Detector. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <script>
        // News carousel functionality
        let currentNewsIndex = 0;
        let newsData = [];
        let newsInterval;
        let autoRefreshInterval;

        // Utility function to shuffle array
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Load news data
        async function loadNews() {
            try {
                console.log('Loading news from NewsAPI...');
                const response = await fetch('/fetch-news', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({page_size: 10, country: 'us', category: 'general'})
                });
                
                if (response.ok) {
                    const data = await response.json();
                    console.log('News API response:', data);
                    newsData = data.articles || [];
                    console.log('Loaded news articles:', newsData.length);
                    
                    if (newsData.length > 0) {
                        // Shuffle the news data to ensure variety
                        newsData = shuffleArray(newsData);
                        console.log(`News shuffled for variety: ${newsData.length} articles`);
                        displayNews();
                        startNewsRotation();
                    } else {
                        console.log('No news articles found from NewsAPI, showing fallback news');
                        showFallbackNews();
                    }
                } else {
                    console.log('News API failed, showing fallback news');
                    showFallbackNews();
                }
            } catch (error) {
                console.error('Error loading news:', error);
                showFallbackNews();
            }
        }

        // Show fallback news when API fails
        function showFallbackNews() {
            console.log('Showing fallback news...');
            
            // Create fallback news data
            newsData = [
                {
                    title: "AI-Powered Fact-Checking Revolutionizes News Verification",
                    description: "Advanced machine learning algorithms are transforming how we verify news authenticity in the digital age.",
                    url: "#",
                    source: { name: "Tech News" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Global Initiative Launches to Combat Misinformation",
                    description: "International organizations join forces to develop new tools and strategies for detecting fake news.",
                    url: "#",
                    source: { name: "Global News" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Digital Literacy Programs Show Promising Results",
                    description: "Educational initiatives teaching media literacy skills are helping users identify reliable sources.",
                    url: "#",
                    source: { name: "Education Today" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Social Media Platforms Implement New Verification Tools",
                    description: "Major platforms introduce AI-powered systems to flag potentially misleading content.",
                    url: "#",
                    source: { name: "Social Media News" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Researchers Develop New Methods for Source Verification",
                    description: "Academic institutions create innovative approaches to verify news sources and credibility.",
                    url: "#",
                    source: { name: "Research Weekly" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Journalism Standards Evolve in Digital Era",
                    description: "News organizations adapt their practices to maintain credibility in an age of rapid information sharing.",
                    url: "#",
                    source: { name: "Journalism Today" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Public Awareness Campaigns Target Misinformation",
                    description: "Government and NGO initiatives educate citizens about identifying and avoiding fake news.",
                    url: "#",
                    source: { name: "Public Affairs" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Technology Companies Invest in Trust and Safety",
                    description: "Major tech firms allocate significant resources to combat misinformation on their platforms.",
                    url: "#",
                    source: { name: "Tech Industry" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Cross-Platform Collaboration Fights Disinformation",
                    description: "Different organizations work together to share intelligence and coordinate responses to fake news.",
                    url: "#",
                    source: { name: "Collaboration News" },
                    publishedAt: new Date().toISOString()
                },
                {
                    title: "Future of News Verification Looks Bright",
                    description: "Emerging technologies promise even more sophisticated tools for maintaining information integrity.",
                    url: "#",
                    source: { name: "Future News" },
                    publishedAt: new Date().toISOString()
                }
            ];
            
            // Shuffle the fallback news
            newsData = shuffleArray(newsData);
            console.log(`Fallback news loaded: ${newsData.length} articles`);
            
            // Display and start rotation
            displayNews();
            startNewsRotation();
        }

        // Show message when no news is available (kept for compatibility)
        function showNoNewsMessage() {
            showFallbackNews(); // Use fallback instead of showing "no news" message
        }

        // Display news banners
        function displayNews() {
            const container = document.getElementById('news-container');
            
            if (!container) return;

            container.innerHTML = '';

            newsData.forEach((news, index) => {
                // Create news banner
                const banner = document.createElement('div');
                banner.className = 'w-full flex-shrink-0 relative';
                banner.innerHTML = `
                    <div class="relative h-64 md:h-80 bg-gradient-to-r from-primary/20 to-accent/20 rounded-2xl overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-br from-black/50 to-transparent"></div>
                        <div class="relative z-10 p-8 h-full flex flex-col justify-end">
                            <div class="text-sm text-white/80 mb-2">${news.source?.name || 'News Source'}</div>
                            <h3 class="text-2xl md:text-3xl font-bold text-white mb-4 line-clamp-2">${news.title}</h3>
                            <p class="text-white/90 mb-4 line-clamp-2">${news.description}</p>
                            <a href="${news.url}" target="_blank" class="inline-flex items-center text-white hover:text-primary transition-colors">
                                Read More <span class="ml-2">‚Üí</span>
                            </a>
                        </div>
                    </div>
                `;
                container.appendChild(banner);

                // Indicators removed as requested
            });
        }

        // Start automatic news rotation
        function startNewsRotation() {
            if (newsData.length <= 1) return;
            
            // Clear any existing interval
            if (newsInterval) {
                clearInterval(newsInterval);
            }
            
            console.log(`Starting news rotation with ${newsData.length} articles, rotating every 4 seconds`);
            
            newsInterval = setInterval(() => {
                currentNewsIndex = (currentNewsIndex + 1) % newsData.length;
                updateNewsDisplay();
                console.log(`Rotating to news index: ${currentNewsIndex}`);
            }, 4000); // Exactly 4 seconds
        }

        // Update news display
        function updateNewsDisplay() {
            const container = document.getElementById('news-container');
            
            if (!container || newsData.length === 0) return;

            // Ensure we don't go out of bounds
            if (currentNewsIndex >= newsData.length) {
                currentNewsIndex = 0;
            }
            if (currentNewsIndex < 0) {
                currentNewsIndex = newsData.length - 1;
            }

            container.style.transform = `translateX(-${currentNewsIndex * 100}%)`;
        }

        // Navigation function removed as requested

        // Load user feedback
        async function loadFeedback() {
            try {
                console.log('Loading user feedback...');
                const response = await fetch('/api/feedback');
                if (response.ok) {
                    const data = await response.json();
                    console.log('Feedback API response:', data);
                    displayFeedback(data.feedback || []);
                } else {
                    console.log('Feedback API failed, showing empty state');
                    displayFeedback([]);
                }
            } catch (error) {
                console.error('Error loading feedback:', error);
                displayFeedback([]);
            }
        }

        // Refresh feedback display (called after new feedback submission)
        async function refreshFeedback() {
            console.log('Refreshing feedback display...');
            await loadFeedback();
        }

        // Display user feedback
        function displayFeedback(feedback) {
            const container = document.getElementById('feedback-container');
            if (!container) return;

            if (feedback.length === 0) {
                container.innerHTML = `
                    <div class="col-span-full text-center text-gray-500 dark:text-gray-400 py-12">
                        <div class="text-6xl mb-4">üí¨</div>
                        <h3 class="text-xl font-semibold mb-2">No feedback yet</h3>
                        <p class="mb-4">Be the first to share your experience with our fake news detector!</p>
                        <a href="/" class="inline-flex items-center bg-gradient-to-r from-primary to-accent text-background-dark px-6 py-3 rounded-lg font-semibold hover:shadow-lg transition-all duration-300">
                            <span class="mr-2">üîç</span>
                            Try Our Detector
                        </a>
                    </div>
                `;
                return;
            }

            container.innerHTML = feedback.map(item => `
                <div class="bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-xl p-6 shadow-lg border border-white/20 dark:border-gray-700/30">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-primary to-accent rounded-full flex items-center justify-center text-white font-bold text-lg">
                            ${item.name.charAt(0)}
                        </div>
                        <div class="ml-4">
                            <h4 class="font-semibold text-gray-900 dark:text-white">${item.name}</h4>
                            <div class="flex text-yellow-400">
                                ${'‚òÖ'.repeat(item.rating || 5)}${'‚òÜ'.repeat(5 - (item.rating || 5))}
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 dark:text-gray-400">"${item.feedback}"</p>
                </div>
            `).join('');
        }

        // Auto-refresh news every minute
        function startAutoRefresh() {
            // Clear any existing auto-refresh interval
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
            }
            
            // Set up auto-refresh every 60 seconds (1 minute)
            autoRefreshInterval = setInterval(async () => {
                console.log('Auto-refreshing news...');
                try {
                    const response = await fetch('/fetch-news', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({page_size: 10, country: 'us', category: 'general'})
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        const newNewsData = data.articles || [];
                        
                        if (newNewsData.length > 0) {
                            // Always shuffle the news data to ensure variety
                            newsData = shuffleArray(newNewsData);
                            currentNewsIndex = 0; // Reset to first news item
                            displayNews();
                            startNewsRotation(); // Restart rotation with new data
                            console.log(`Auto-refresh: Loaded ${newsData.length} new articles (shuffled for variety)`);
                        } else {
                            console.log('Auto-refresh: No new articles found');
                        }
                    } else {
                        console.log('Auto-refresh: NewsAPI request failed');
                    }
                } catch (error) {
                    console.error('Auto-refresh error:', error);
                }
            }, 60000); // 60 seconds = 1 minute
        }

        // Stop auto-refresh
        function stopAutoRefresh() {
            if (autoRefreshInterval) {
                clearInterval(autoRefreshInterval);
                autoRefreshInterval = null;
            }
        }


        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Home page initialized, loading news...');
            
            // Load news immediately
            loadNews();
            loadFeedback();
            
            // Start auto-refresh after initial load
            setTimeout(() => {
                startAutoRefresh();
            }, 5000); // Start auto-refresh 5 seconds after page load
            
            // Ensure news is always displayed after a short delay
            setTimeout(() => {
                if (!newsData || newsData.length === 0) {
                    console.log('No news data found, loading fallback news...');
                    showFallbackNews();
                }
            }, 2000);
            
            // Carousel controls removed as requested

        });

        // Clean up intervals when page is unloaded
        window.addEventListener('beforeunload', function() {
            stopAutoRefresh();
            if (newsInterval) {
                clearInterval(newsInterval);
            }
        });
    </script>
</body>
</html>

